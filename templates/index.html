<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>KODOKRIYAL | Arbitrage Terminal</title>
    <!-- Tailwind CSS v3 with Plugins -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Google Fonts: JetBrains Mono for the terminal aesthetic -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap"
        rel="stylesheet" />
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    colors: {
                        'ultra-dark': '#05070a',
                        'neon-green': '#10b981',
                        'cyber-blue': '#3b82f6',
                        'warning-gold': '#f59e0b',
                    },
                    fontSize: {
                        'xxs': '0.65rem',
                    }
                }
            }
        }
    </script>
    <style data-purpose="custom-layout">
        body {
            background-color: #05070a;
            color: #e2e8f0;
            font-family: 'JetBrains Mono', monospace;
            -webkit-font-smoothing: antialiased;
        }

        .terminal-border {
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .zebra-row:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.02);
        }

        .scanner-line {
            height: 1px;
            background: linear-gradient(90deg, transparent, #10b981, transparent);
            animation: scan 3s linear infinite;
        }

        @keyframes scan {
            0% {
                transform: translateY(0);
            }

            100% {
                transform: translateY(100vh);
            }
        }

        /* Thin scrollbar for terminal feel */
        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: #05070a;
        }

        ::-webkit-scrollbar-thumb {
            background: #1e293b;
        }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden text-sm">

    <!-- BEGIN: TopBar -->
    <header class="h-8 bg-black overflow-x-auto no-scrollbar border-b border-white/10 flex items-center justify-between px-4 shrink-0"
        data-purpose="main-header">
        <div class="flex items-center gap-6">
            <div class="flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-neon-green animate-pulse"></span>
                <span class="font-bold tracking-widest text-cyber-blue">KODOKRIYAL v2.1.0</span>
            </div>
            <div class="flex items-center gap-2 md:gap-4 text-white/50 border-l border-white/10 pl-2 md:pl-4 text-[9px] md:text-xs whitespace-nowrap">
                <span><span class="hidden sm:inline">STATUS: </span><span id="system-status" class="text-neon-green">SISTEM AKTIF</span></span>
                <span><span class="hidden sm:inline">BINANCE: </span><span id="binance-status" class="text-neon-green">STABLE</span></span>
            </div>
        </div>
        <div class="flex items-center gap-3 text-white/70">
            <span class="font-mono" id="digital-clock">--:--:-- WIB | --/--/----</span>
            <div class="bg-neon-green/10 text-neon-green px-2 py-0.5 border border-neon-green/30 text-xs">
                LIVE FEED
            </div>
            <button onclick="syncData()"
                class="flex items-center gap-1.5 bg-neon-green/10 hover:bg-neon-green/20 text-neon-green px-3 py-1 border border-neon-green/30 text-xxs uppercase tracking-widest transition-all active:scale-95"
                data-purpose="refresh-button">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                        stroke-linecap="round" stroke-linejoin="round" stroke-width="2" />
                </svg>
                REFRESH
            </button>
        </div>
    </header>
    <!-- END: TopBar -->

    <!-- BEGIN: MainContent -->
    <main class="flex-grow p-3 grid grid-cols-12 gap-3 overflow-y-auto lg:overflow-hidden" data-purpose="dashboard-grid">

        <!-- BEGIN: Column 1 - Kurs Displays -->
        <section class="col-span-12 lg:col-span-3 flex flex-col gap-2 items-start overflow-y-auto"
            data-purpose="kurs-metrics">
            <!-- Google SAR Card -->
            <div class="bg-white/5 border p-2 flex flex-col relative overflow-hidden group h-fit w-full">
                <div class="flex items-center justify-between">
                    <h3 class="text-cyber-blue font-bold uppercase tracking-tighter text-base">KURS GOOGLE SAR</h3>
                    <span id="margin-indicator" class="text-cyber-blue text-xs">+0.00%</span>
                </div>
                <p id="val-google-sar" class="text-2xl font-bold text-white tabular-nums mt-0.5">0.00</p>
                <p class="text-base text-white/40 uppercase tracking-widest">IDR / Saudi Riyal</p>
            </div>

            <!-- XE.com SAR Card -->
            <div class="bg-white/5 border p-2 flex flex-col relative overflow-hidden group h-fit w-full">
                <div class="flex items-center justify-between">
                    <h3 class="text-cyber-blue font-bold uppercase tracking-tighter text-base">KURS XE.COM SAR</h3>
                    <span id="xe-update-time" class="text-cyber-blue text-xs">JUST NOW</span>
                </div>
                <p id="val-xe-sar" class="text-2xl font-bold text-white tabular-nums mt-0.5">0.00</p>
                <p class="text-base text-white/40 uppercase tracking-widest">IDR / Saudi Riyal</p>
            </div>

            <!-- TokoCrypto Card -->
            <div class="bg-white/5 border p-2 flex flex-col relative overflow-hidden group h-fit w-full">
                <div class="flex items-center justify-between">
                    <h3 class="text-warning-gold font-bold uppercase tracking-tighter text-base">KURS TOKOCRYPTO NET
                    </h3>
                    <span class="bg-warning-gold/20 text-warning-gold text-xs px-1 font-bold">PAJAK 0.2%</span>
                </div>
                <div class="flex items-baseline justify-between mt-0.5">
                    <p id="val-tko-raw" class="text-2xl font-bold text-white tabular-nums">0.00</p>
                    <span id="val-tko-net" class="text-sm text-white/50">NET: Rp 0.00</span>
                </div>
            </div>

            <!-- Kalkulator Arbitrase -->
            <div class="bg-white/5 border p-2 flex flex-col relative overflow-hidden group h-fit w-full">
                <h3 class="text-warning-gold font-bold uppercase tracking-tighter mb-1.5 text-base">KALKULATOR
                    ARBITRASE</h3>
                <div class="space-y-1.5">
                    <div class="flex flex-col gap-0.5">
                        <label class="text-base text-white/40 uppercase">Jumlah SAR (Buyer)</label>
                        <input id="calc-sar"
                            class="bg-black border border-white/10 text-white text-base px-2 py-0.5 focus:border-neon-green outline-none w-full"
                            placeholder="1000" type="text" value="1000" />
                    </div>
                    <div class="flex flex-col gap-0.5">
                        <label class="text-base text-white/40 uppercase">Rate Jual ke Buyer (IDR/SAR)</label>
                        <input id="calc-rate-jual"
                            class="bg-black border border-white/10 text-white text-base px-2 py-0.5 focus:border-neon-green outline-none w-full"
                            placeholder="4480" type="text" value="4480" />
                    </div>
                    <div class="grid grid-cols-2 gap-1.5">
                        <div class="flex flex-col gap-0.5">
                            <label class="text-base text-white/40 uppercase">Rate P2P Saudi</label>
                            <input id="calc-rate-p2p"
                                class="bg-black border border-white/10 text-white text-base px-2 py-0.5 focus:border-neon-green outline-none w-full"
                                placeholder="3.80" type="text" value="3.80" />
                        </div>
                        <div class="flex flex-col gap-0.5">
                            <label class="text-base text-white/40 uppercase">Harga Toko (IDR)</label>
                            <input id="calc-rate-toko"
                                class="bg-black border border-white/10 text-white text-base px-2 py-0.5 focus:border-neon-green outline-none w-full"
                                placeholder="16865" type="text" value="16865" />
                        </div>
                    </div>
                    <button onclick="runCalc()"
                        class="w-full bg-neon-green text-black font-bold text-base py-1 mt-1 hover:bg-neon-green/80 transition-colors uppercase tracking-widest">HITUNG</button>
                </div>
            </div>

            <!-- Latency Widget -->
            <div class="bg-white/5 border p-3 flex flex-col relative overflow-hidden group h-fit w-full">
                <div class="flex justify-between mb-1">
                    <span class="text-white/40 text-xxs uppercase">Latency</span>
                    <span id="latency-val" class="text-neon-green">--ms</span>
                </div>
                <div class="w-full bg-white/5 h-1">
                    <div id="latency-bar" class="bg-neon-green h-full w-[0%]"></div>
                </div>
            </div>
        </section>
        <!-- END: Column 1 -->

        <!-- BEGIN: Columns 2 & 3 - P2P Tables -->
        <section class="col-span-12 lg:col-span-6 grid grid-cols-1 md:grid-cols-2 gap-3 h-full" data-purpose="p2p-tables">
            <!-- Indonesia Table -->
            <div class="bg-white/5 border border-white/10 flex flex-col">
                <div class="p-2 bg-white/5 border-b border-white/10">
                    <h2 class="font-bold text-cyber-blue uppercase tracking-widest text-center">P2P INDONESIA (IDR)</h2>
                    <div class="grid grid-cols-2 gap-x-4 gap-y-0.5 mt-2 pt-2 border-t border-white/10 text-sm whitespace-nowrap">
                        <div><span class="text-white/40">TKC:</span> <span id="sub-toko"
                                class="text-white">--</span>
                        </div>
                        <div><span class="text-white/40">IDX:</span> <span id="sub-indodax"
                                class="text-white">--</span></div>
                        <div><span class="text-white/40">PTU:</span> <span id="sub-pintu" class="text-white">--</span>
                        </div>
                        <div><span class="text-white/40">OSL:</span> <span id="sub-osl" class="text-white">--</span>
                        </div>
                    </div>
                </div>
                <div class="flex-grow p-1 flex flex-col gap-2">
                    <div class="border border-white/5">
                        <div class="bg-white/5 text-base px-2 py-1 font-bold text-neon-green">P2P BUY (INDO)</div>
                        <div>
                            <table class="w-full text-base">
                                <tbody id="table-p2p-indo-buy" class="text-white/60"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="border border-white/5">
                        <div class="bg-white/5 text-base px-2 py-1 font-bold text-cyber-blue">P2P SELL (INDO)</div>
                        <div>
                            <table class="w-full text-base">
                                <tbody id="table-p2p-indo-sell" class="text-white/60"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Saudi Table -->
            <div class="bg-white/5 border border-white/10 flex flex-col">
                <div class="p-2 bg-white/5 border-b border-white/10">
                    <h2 class="font-bold text-warning-gold uppercase tracking-widest text-center">P2P SAUDI (SAR)</h2>
                    <div class="flex justify-center mt-2 pt-2 border-t border-white/10 text-base">
                        <span class="text-white/40">USDT/SAR SPOT:</span> <span id="sub-sar-spot"
                            class="text-white ml-2">--</span>
                    </div>
                </div>
                <div class="flex-grow p-1 flex flex-col gap-2">
                    <div class="border border-white/5">
                        <div class="bg-white/5 text-base px-2 py-1 font-bold text-neon-green">P2P BUY (SAUDI)</div>
                        <div>
                            <table class="w-full text-base">
                                <tbody id="table-p2p-saudi-buy" class="text-white/60"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="border border-white/5">
                        <div class="bg-white/5 text-base px-2 py-1 font-bold text-cyber-blue">P2P SELL (SAUDI)</div>
                        <div>
                            <table class="w-full text-base">
                                <tbody id="table-p2p-saudi-sell" class="text-white/60"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </section>
        <!-- END: Columns 2 & 3 -->

        <!-- BEGIN: Column 4 - Simulasi Cuan -->
        <section class="col-span-12 lg:col-span-3 flex flex-col gap-3 overflow-y-auto" data-purpose="profit-simulation">
            <div class="bg-white/5 border border-neon-green/30 flex flex-col">
                <div class="p-2 bg-neon-green/10 border-b border-neon-green/20">
                    <h2 class="font-bold text-neon-green uppercase tracking-widest text-center text-base">SIMULASI SAR
                        NET + FEE</h2>
                </div>
                <div id="sim-divider" class="p-2 space-y-1"></div>
                <div class="p-2 bg-white/5">
                    <p class="text-[10px] text-white/30 leading-tight italic">
                        *Estimasi. Dapat berubah sewaktu-waktu.
                    </p>
                </div>
            </div>

            <!-- BEGIN: Profit Simulation Table -->
            <div class="bg-white/5 border border-white/10 flex flex-col">
                <div class="p-2 bg-white/5 border-b border-white/10">
                    <h2 class="font-bold text-neon-green uppercase tracking-widest text-center text-base">SIMULASI
                        PROFIT (ESTIMASI BERSIH)</h2>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-base border-collapse">
                        <thead>
                            <tr class="bg-white/10 text-white/40 uppercase font-bold text-base">
                                <th class="p-1 md:p-2 text-left">Modal (SAR)</th>
                                <th class="p-1 md:p-2 text-right">Est. Profit (IDR)</th>
                                <th class="p-1 md:p-2 text-right">ROI (%)</th>
                            </tr>
                        </thead>
                        <tbody id="table-profit-sim" class="text-white/60"></tbody>
                    </table>
                </div>
            </div>
            <!-- END: Profit Simulation Table -->
        </section>
        <!-- END: Column 4 -->

    </main>
    <!-- END: MainContent -->


    <!-- JavaScript for live clock, data sync, and calculator -->
    <script data-purpose="app-logic">
        const fmt = (v, dec = 2) => v ? Number(v).toLocaleString('id-ID', { minimumFractionDigits: dec, maximumFractionDigits: dec }) : '0';

        function updateClock() {
            const now = new Date();
            const h = String(now.getHours()).padStart(2, '0');
            const m = String(now.getMinutes()).padStart(2, '0');
            const s = String(now.getSeconds()).padStart(2, '0');
            const dd = String(now.getDate()).padStart(2, '0');
            const mm = String(now.getMonth() + 1).padStart(2, '0');
            const yyyy = now.getFullYear();
            document.getElementById('digital-clock').textContent = `${h}:${m}:${s} WIB | ${dd}/${mm}/${yyyy}`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        function addLog(msg) {
            console.log(msg.replace(/<[^>]*>/g, ''));
        }

        function renderP2PTable(data, tbodyId, isSAR, highlight) {
            let html = '';
            data.forEach((x, i) => {
                const colorClass = i === 0 ? highlight : '';
                const priceStr = isSAR
                    ? x.price.toFixed(2)
                    : Number(x.price).toLocaleString('id-ID', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                html += `<tr class="zebra-row"><td class="p-1">${x.name}</td><td class="p-1 text-right ${colorClass}">${priceStr}</td></tr>`;
            });
            document.getElementById(tbodyId).innerHTML = html;
        }

        async function syncData() {
            const t0 = performance.now();
            try {
                addLog('Sinkronisasi data dimulai...');
                const res = await fetch('/api/data');
                const d = await res.json();
                const latency = Math.round(performance.now() - t0);

                // Clock info
                document.getElementById('digital-clock').textContent = `${d.time} WIB | ${d.date}`;

                // Kurs Cards
                document.getElementById('val-google-sar').textContent = fmt(d.google_sar);
                document.getElementById('val-xe-sar').textContent = fmt(d.xe_sar);
                document.getElementById('val-tko-raw').textContent = fmt(d.tko_raw);
                document.getElementById('val-tko-net').textContent = `NET: Rp ${fmt(d.tko_net)}`;

                // Margin indicator
                if (d.google_sar && d.tko_net) {
                    const base = d.tko_net / 3.79;
                    const margin = ((d.google_sar - base) / base * 100);
                    document.getElementById('margin-indicator').textContent = `${margin >= 0 ? '+' : ''}${margin.toFixed(2)}%`;
                    document.getElementById('margin-indicator').className = margin >= 0 ? 'text-neon-green' : 'text-red-500';
                }

                // Sub-header exchange values
                document.getElementById('sub-toko').textContent = fmt(d.tko_raw, 0);
                document.getElementById('sub-indodax').textContent = d.indodax_raw ? fmt(d.indodax_raw, 0) : '--';
                document.getElementById('sub-pintu').textContent = d.pintu_raw ? fmt(d.pintu_raw, 0) : '--';
                document.getElementById('sub-osl').textContent = d.osl_raw ? fmt(d.osl_raw, 0) : '--';

                // SAR spot (use first Saudi buy price if available)
                if (d.p2p_saudi_buy && d.p2p_saudi_buy.length > 0) {
                    document.getElementById('sub-sar-spot').textContent = d.p2p_saudi_buy[0].price.toFixed(2);
                }

                // P2P Tables — BUY and SELL
                renderP2PTable(d.p2p_indo_buy, 'table-p2p-indo-buy', false, 'text-warning-gold');
                renderP2PTable(d.p2p_indo_sell, 'table-p2p-indo-sell', false, 'text-neon-green');
                renderP2PTable(d.p2p_saudi_buy, 'table-p2p-saudi-buy', true, 'text-neon-green');
                renderP2PTable(d.p2p_saudi_sell, 'table-p2p-saudi-sell', true, 'text-warning-gold');

                // Profit Simulation Table
                let hP = '';
                d.profit_sim.forEach(s => {
                    const color = s.idr >= 0 ? 'text-neon-green' : 'text-red-500';
                    hP += `<tr class="zebra-row border-b border-white/5">
          <td class="p-2 font-mono">${s.sar}</td>
          <td class="p-2 text-right font-bold ${color}">Rp ${Number(s.idr).toLocaleString('id-ID')}</td>
          <td class="p-2 text-right font-bold ${color}">${s.roi.toFixed(2)}%</td>
        </tr>`;
                });
                document.getElementById('table-profit-sim').innerHTML = hP;

                // Divider Simulation
                let hD = '';
                d.sim_div.forEach(item => {
                    hD += `<div class="flex justify-between items-center border-b border-white/5 py-1 px-1">
            <span class="text-white/40 text-base uppercase">${item.label}</span>
            <span class="text-base font-bold text-white">${fmt(item.val)} IDR</span>
          </div>`;
                });
                document.getElementById('sim-divider').innerHTML = hD;

                // Latency
                document.getElementById('latency-val').textContent = `${latency}ms`;
                const pct = Math.min(100, Math.max(5, 100 - (latency / 30)));
                document.getElementById('latency-bar').style.width = `${pct}%`;
                document.getElementById('latency-bar').className = latency < 500 ? 'bg-neon-green h-full' : latency < 2000 ? 'bg-warning-gold h-full' : 'bg-red-500 h-full';

                // XE Update
                document.getElementById('xe-update-time').textContent = 'JUST NOW';

                // Auto-fill calculator with live rates
                if (d.p2p_saudi_buy && d.p2p_saudi_buy.length > 0) {
                    document.getElementById('calc-rate-p2p').value = d.p2p_saudi_buy[0].price.toFixed(2);
                }
                if (d.tko_raw) {
                    document.getElementById('calc-rate-toko').value = Math.round(d.tko_raw);
                }
                if (d.google_sar) {
                    document.getElementById('calc-rate-jual').value = Math.round(d.google_sar);
                }

                addLog(`Sinkronisasi data Google Finance... <span class="text-neon-green">BERHASIL (SAR/IDR: ${fmt(d.google_sar)})</span>`);
                addLog(`Mengambil spot rate Tokocrypto... <span class="text-neon-green">${fmt(d.tko_raw)} IDR</span>`);
                addLog(`Kalkulasi SIMULASI SAR NET + FEE selesai...`);
                addLog(`Pemindaian Gateway P2P (Indo &amp; Saudi) aktif...`);
                addLog(`<span class="text-neon-green">SYNC COMPLETE</span> — Latency: ${latency}ms`);

                document.getElementById('system-status').textContent = 'SISTEM AKTIF';
                document.getElementById('system-status').className = 'text-neon-green';
                document.getElementById('binance-status').textContent = 'STABLE';
                document.getElementById('binance-status').className = 'text-neon-green';



            } catch (e) {
                console.error(e);
                addLog(`<span class="text-red-500">ERROR: Gagal sinkronisasi — ${e.message}</span>`);
                document.getElementById('system-status').textContent = 'ERROR';
                document.getElementById('system-status').className = 'text-red-500';
                document.getElementById('binance-status').textContent = 'OFFLINE';
                document.getElementById('binance-status').className = 'text-red-500';
            }
        }

        function runCalc() {
            const sarAmount = parseFloat(document.getElementById('calc-sar').value) || 0;
            const rateJual = parseFloat(document.getElementById('calc-rate-jual').value) || 0;
            const rateP2P = parseFloat(document.getElementById('calc-rate-p2p').value) || 0;
            const rateToko = parseFloat(document.getElementById('calc-rate-toko').value) || 0;

            if (sarAmount && rateJual && rateP2P && rateToko) {
                // 1. Buyer bayar IDR
                const buyerBayar = sarAmount * rateJual;

                // 2. USDT yang dibutuhkan (SAR / rate P2P Saudi)
                const usdtNeeded = sarAmount / rateP2P;

                // 3. Modal beli USDT di Tokocrypto (+ fee 0.2222%)
                const tokoNet = rateToko * (1 + 0.2222 / 100);
                const modalIdr = usdtNeeded * tokoNet;

                // 4. Profit & ROI
                const profit = buyerBayar - modalIdr;
                const roi = modalIdr > 0 ? (profit / modalIdr * 100) : 0;
                const kursEfektif = modalIdr / sarAmount;

                // Populate modal
                document.getElementById('m-sar-amount').textContent = `${sarAmount.toLocaleString('id-ID')} SAR`;
                document.getElementById('m-buyer-bayar').textContent = `Rp ${Math.round(buyerBayar).toLocaleString('id-ID')}`;
                document.getElementById('m-usdt-needed').textContent = `${usdtNeeded.toLocaleString('id-ID', { maximumFractionDigits: 2 })} USDT`;
                document.getElementById('m-modal-idr').textContent = `Rp ${Math.round(modalIdr).toLocaleString('id-ID')}`;
                document.getElementById('m-kurs-efektif').textContent = `Rp ${Math.round(kursEfektif).toLocaleString('id-ID')}/SAR`;

                const profitEl = document.getElementById('m-profit');
                profitEl.textContent = `${profit >= 0 ? '+' : ''}Rp ${Math.round(Math.abs(profit)).toLocaleString('id-ID')}`;
                profitEl.className = `text-2xl font-bold ${profit >= 0 ? 'text-neon-green' : 'text-red-500'}`;

                const roiEl = document.getElementById('m-roi');
                roiEl.textContent = `${roi >= 0 ? '+' : ''}${roi.toFixed(2)}%`;
                roiEl.className = `text-sm font-bold ${roi >= 0 ? 'text-warning-gold' : 'text-red-500'}`;

                // Show modal
                const m = document.getElementById('calc-modal');
                m.classList.remove('hidden');
                m.classList.add('flex');
            }
        }

        function closeCalcModal() {
            const m = document.getElementById('calc-modal');
            m.classList.add('hidden');
            m.classList.remove('flex');
        }

        // Close modal on backdrop click
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('calc-modal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('calc-modal')) closeCalcModal();
            });
        });

        // Auto-refresh every 60 seconds
        setInterval(syncData, 60000);
        // Initial load
        syncData();
    </script>

    <!-- Calculator Result Modal -->
    <div id="calc-modal" class="fixed inset-0 z-[100] hidden items-center justify-center"
        style="background:rgba(0,0,0,0.7);backdrop-filter:blur(6px)">
        <div id="calc-modal-content"
            class="relative w-[90%] max-w-md border border-neon-green/30 bg-[#0a0e14] shadow-2xl shadow-neon-green/10"
            style="animation:modalIn 0.25s ease-out">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 bg-neon-green/10 border-b border-neon-green/20">
                <div class="flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-neon-green animate-pulse"></span>
                    <h3 class="text-neon-green font-bold uppercase tracking-widest text-xs">HASIL KALKULASI ARBITRASE
                    </h3>
                </div>
                <button onclick="closeCalcModal()"
                    class="text-white/40 hover:text-white transition-colors text-lg leading-none">&times;</button>
            </div>
            <!-- Body -->
            <div class="p-5 space-y-3">
                <!-- Step 1: Buyer -->
                <div class="bg-cyber-blue/5 border border-cyber-blue/20 p-3">
                    <p class="text-base text-cyber-blue uppercase mb-1 font-bold">① Buyer Butuh & Bayar</p>
                    <div class="flex justify-between items-center">
                        <span id="m-sar-amount" class="text-sm font-bold text-white">0 SAR</span>
                        <span class="text-white/30">→</span>
                        <span id="m-buyer-bayar" class="text-sm font-bold text-cyber-blue">Rp 0</span>
                    </div>
                </div>
                <!-- Step 2: Beli USDT -->
                <div class="bg-warning-gold/5 border border-warning-gold/20 p-3">
                    <p class="text-base text-warning-gold uppercase mb-1 font-bold">② Beli USDT di Tokocrypto</p>
                    <div class="flex justify-between items-center">
                        <span id="m-usdt-needed" class="text-sm font-bold text-white">0 USDT</span>
                        <span class="text-white/30">→</span>
                        <span id="m-modal-idr" class="text-sm font-bold text-warning-gold">Rp 0</span>
                    </div>
                    <p class="text-base text-white/30 mt-1">Kurs efektif: <span id="m-kurs-efektif"
                            class="text-white/60">Rp 0/SAR</span></p>
                </div>
                <!-- Step 3: Profit -->
                <div class="bg-neon-green/5 border border-neon-green/20 p-4 text-center">
                    <p class="text-base text-white/40 uppercase mb-1">Estimasi Profit Bersih</p>
                    <p id="m-profit" class="text-2xl font-bold text-neon-green">Rp 0</p>
                    <p id="m-roi" class="text-sm font-bold text-warning-gold mt-1">0.00%</p>
                </div>
                <div class="flex items-center gap-2 pt-2 border-t border-white/10">
                    <svg class="w-3 h-3 text-white/30" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                            clip-rule="evenodd" />
                    </svg>
                    <p class="text-base text-white/30 italic">Estimasi. Harga aktual dapat berbeda saat eksekusi.</p>
                </div>
            </div>
            <!-- Footer -->
            <div class="p-3 bg-white/5 border-t border-white/10">
                <button onclick="closeCalcModal()"
                    class="w-full bg-neon-green text-black font-bold text-base py-2 hover:bg-neon-green/80 transition-colors uppercase tracking-widest">TUTUP</button>
            </div>
        </div>
    </div>
    <style>
        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(10px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
    </style>

    <!-- Scanner line effect -->
    <div class="scanner-line pointer-events-none fixed top-0 left-0 w-full z-50 opacity-10"></div>

</body>

</html>